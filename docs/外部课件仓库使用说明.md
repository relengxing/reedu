# 外部课件仓库使用说明

## 概述

课件框架支持从外部Git仓库加载课件，实现课件和框架代码的解耦。课件可以单独维护在一个独立的Git项目中。

## 使用方式

### 方式一：通过配置页面设置（推荐）

1. 在应用顶部导航栏点击"配置"标签
2. 输入课件仓库的URL和分支
3. 点击"加载课件"按钮

### 方式二：通过环境变量设置

在 `.env` 文件中设置：

```env
VITE_COURSEWARE_REPO_URL=https://raw.githubusercontent.com/user/repo/main/
VITE_COURSEWARE_BRANCH=main
```

应用启动时会自动加载课件。

## 课件仓库结构

### 1. 创建Git仓库

创建一个独立的Git仓库来存放课件文件，例如：

```
courseware-repo/
├── manifest.json
├── 一元二次方程组/
│   ├── 上下坡问题.html
│   ├── 应用题.html
│   └── 火车资源/
│       └── 火车头刚好进入隧道.mp3
└── 默认组/
    ├── 封面页.html
    └── 选择题.html
```

### 2. 创建manifest.json

在仓库根目录创建 `manifest.json` 文件，列出所有课件组和文件：

```json
{
  "groups": [
    {
      "id": "一元二次方程组",
      "name": "一元二次方程组",
      "files": [
        "一元二次方程组/上下坡问题.html",
        "一元二次方程组/应用题.html"
      ]
    },
    {
      "id": "default",
      "name": "默认组",
      "files": [
        "默认组/封面页.html",
        "默认组/选择题.html"
      ]
    }
  ]
}
```

**字段说明：**
- `id`: 课件组ID（用于生成课程URL的MD5）
- `name`: 课件组显示名称
- `files`: 该组下的所有HTML课件文件路径（相对于仓库根目录）

### 3. 组织课件文件

- 每个文件夹是一组课件
- HTML课件文件放在对应的文件夹中
- 音频等资源文件可以放在子文件夹中，使用相对路径引用

## 仓库URL格式

### GitHub

```
https://raw.githubusercontent.com/用户名/仓库名/分支名/
```

例如：
```
https://raw.githubusercontent.com/username/courseware-repo/main/
```

### GitLab

```
https://gitlab.com/用户名/仓库名/-/raw/分支名/
```

### Gitee

```
https://gitee.com/用户名/仓库名/raw/分支名/
```

### 其他Git托管服务

使用对应的raw内容URL格式即可。

## 音频文件处理

课件中的音频文件使用相对路径引用，例如：

```javascript
new Audio('./火车资源/火车头刚好进入隧道.mp3')
```

系统会自动将相对路径转换为完整的URL。

## 注意事项

1. **manifest.json必须存在**：仓库必须包含manifest.json文件，否则无法加载课件
2. **文件路径要正确**：manifest.json中的文件路径必须与实际文件路径一致
3. **CORS限制**：如果使用GitHub等服务的raw URL，需要确保仓库是公开的，或者配置了CORS
4. **网络连接**：需要确保应用可以访问课件仓库的URL
5. **音频文件**：音频文件路径使用相对路径，系统会自动转换为完整URL

## 示例

### 完整的manifest.json示例

```json
{
  "groups": [
    {
      "id": "一元二次方程组",
      "name": "一元二次方程组",
      "files": [
        "一元二次方程组/上下坡问题.html",
        "一元二次方程组/应用题.html",
        "一元二次方程组/火车优化1.html"
      ]
    },
    {
      "id": "环形道路",
      "name": "环形道路相遇问题",
      "files": [
        "环形道路/环形道路相遇问题.html"
      ]
    },
    {
      "id": "default",
      "name": "默认组",
      "files": [
        "封面页.html",
        "选择题.html",
        "练习1填空题.html"
      ]
    }
  ]
}
```

### 课件HTML中的音频引用示例

```html
<script>
  const audio = new Audio('./火车资源/火车头刚好进入隧道.mp3');
  audio.play();
</script>
```

## 优势

1. **解耦**：课件和框架代码分离，可以独立维护
2. **版本控制**：课件可以单独进行版本控制
3. **协作**：多人可以同时维护课件，互不干扰
4. **部署灵活**：可以单独更新课件，无需重新部署框架
5. **多环境**：可以为不同环境配置不同的课件仓库

