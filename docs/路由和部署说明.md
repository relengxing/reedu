# 路由和部署说明

## 路由格式

应用支持以下路由格式：

1. **固定路由**：
   - `/` - 首页（课件导航）
   - `/home` - 首页
   - `/config` - 配置页
   - `/catalog` - 目录页
   - `/player/:coursewareIndex/:pageIndex` - 课件播放器（使用索引）

2. **课程路由（推荐）**：
   - `/:courseId` - 课程首页（自动跳转到第0页）
   - `/:courseId/:pageIndex` - 课程指定页面
   - 其中 `courseId` 是32位MD5字符串，`pageIndex` 是页面索引（从0开始）

## 刷新404问题

### 开发环境

Vite开发服务器默认已经支持History API fallback，刷新页面不会出现404。

### 生产环境

如果部署到生产环境后刷新页面出现404，需要配置服务器将所有路由重定向到 `index.html`。

**好消息**：项目已经包含了常见部署平台的配置文件，构建时会自动复制到 `dist` 目录。

#### 自动配置（推荐）

项目已包含以下配置文件，构建后会自动生效：

1. **Netlify**：`public/_redirects` - 已自动配置
2. **Vercel**：`vercel.json` - 已自动配置  
3. **Apache**：`public/.htaccess` - 已自动配置

直接部署即可，无需额外配置！

#### 手动配置（如果需要）

##### Nginx配置

如果使用Nginx，参考项目根目录的 `nginx.conf.example` 文件，或使用以下配置：

```nginx
server {
    listen 80;
    server_name your-domain.com;
    root /path/to/dist;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

    # 缓存静态资源
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # Gzip压缩
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css text/xml text/javascript application/x-javascript application/xml+rss application/json application/javascript;
}
```

##### 其他服务器

- **IIS**：需要配置URL重写模块，将所有请求重定向到 `index.html`
- **Caddy**：使用 `try_files {path} /index.html` 指令

## URL格式说明

### 为什么使用 `/:courseId/:pageIndex` 而不是 `/player/:coursewareIndex/:pageIndex`？

1. **更简洁**：URL更短，更容易分享
2. **更稳定**：使用MD5作为课程ID，不依赖于课件在列表中的位置
3. **更直观**：直接通过课程ID和页面索引访问，不需要知道课件在列表中的索引

### 示例

- 访问课程的第一页：`http://localhost:3000/abc123def456.../0`
- 访问课程的第二页：`http://localhost:3000/abc123def456.../1`
- 访问课程首页（自动跳转到第0页）：`http://localhost:3000/abc123def456...`

## 注意事项

1. `courseId` 必须是32位十六进制字符串（MD5哈希值）
2. `pageIndex` 是页面索引，从0开始
3. 如果 `pageIndex` 超出范围，会自动跳转到最后一页
4. 如果只提供 `courseId` 而没有 `pageIndex`，会自动跳转到第0页

