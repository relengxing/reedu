# 路由和部署说明

## 路由格式

应用支持以下路由格式：

1. **固定路由**：
   - `/` - 首页（课件导航）
   - `/home` - 首页
   - `/config` - 配置页
   - `/catalog` - 目录页
   - `/player/:coursewareIndex/:pageIndex` - 课件播放器（使用索引）

2. **课程路由（推荐）**：
   - `/:courseId` - 课程首页（自动跳转到第0页）
   - `/:courseId/:pageIndex` - 课程指定页面
   - 其中 `courseId` 是32位MD5字符串，`pageIndex` 是页面索引（从0开始）

## 刷新404问题

### 开发环境

Vite开发服务器默认已经支持History API fallback，刷新页面不会出现404。

### 生产环境

如果部署到生产环境后刷新页面出现404，需要配置服务器将所有路由重定向到 `index.html`。

#### Nginx配置示例

```nginx
server {
    listen 80;
    server_name your-domain.com;
    root /path/to/dist;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }
}
```

#### Apache配置示例

在 `dist` 目录创建 `.htaccess` 文件：

```apache
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  RewriteRule ^index\.html$ - [L]
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule . /index.html [L]
</IfModule>
```

#### Netlify配置

在项目根目录创建 `netlify.toml`：

```toml
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
```

#### Vercel配置

在项目根目录创建 `vercel.json`：

```json
{
  "rewrites": [
    { "source": "/(.*)", "destination": "/index.html" }
  ]
}
```

## URL格式说明

### 为什么使用 `/:courseId/:pageIndex` 而不是 `/player/:coursewareIndex/:pageIndex`？

1. **更简洁**：URL更短，更容易分享
2. **更稳定**：使用MD5作为课程ID，不依赖于课件在列表中的位置
3. **更直观**：直接通过课程ID和页面索引访问，不需要知道课件在列表中的索引

### 示例

- 访问课程的第一页：`http://localhost:3000/abc123def456.../0`
- 访问课程的第二页：`http://localhost:3000/abc123def456.../1`
- 访问课程首页（自动跳转到第0页）：`http://localhost:3000/abc123def456...`

## 注意事项

1. `courseId` 必须是32位十六进制字符串（MD5哈希值）
2. `pageIndex` 是页面索引，从0开始
3. 如果 `pageIndex` 超出范围，会自动跳转到最后一页
4. 如果只提供 `courseId` 而没有 `pageIndex`，会自动跳转到第0页

